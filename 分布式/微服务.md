# 微服务

## 单体应用

![image-20220309210829466](https://raw.githubusercontent.com/xuhaoyao/images/master/img/image-20220309210829466.png)

这个项目架构，包含了四个模块。可以看出此项目的架构完完全全属于传统的 MVC 架构，所有的子系统都集成在一个很繁杂的 JVM 进程中。

**优点：**

对于小型应用来说很方便，所有代码都在一个项目中，开发起来很方便。

但是当需求越来越多，项目规模越来越大时，坏处也体现出来了。

**缺点：**

1、项目过于臃肿，复杂度高，难以维护。

2、系统高可用性差，某段代码的异常没有处理好，可能导致整个应用垮掉。

3、不灵活，修改任何一处代码，整个项目都要重新打包。

4、无法灵活扩展。比如支付模块的QPS很高，我们只希望提高支付模块接口的QPS，对支付模块做水平扩展，这一点在单体应用是做不到的。

5、资源无法隔离，整个单体系统的各个功能模块都使用同样的数据库、内存等资源。



## 服务化

服务化就是把传统单体应用中通过JAR包依赖产生的本地方法调用，改造成RPC接口产生的远程方法调用。这些服务是围绕业务功能构建的，可以通过全自动部署机制独立部署。这些**服务的集中管理最少，可以用不同的编程语言去编写，使用不同的存储技术**。

**可以把耦合度较高的模块，独立数据源，独立成一个服务部署，以 RPC  接口的形式对外提供服务。**

![image-20220309212738215](https://raw.githubusercontent.com/xuhaoyao/images/master/img/image-20220309212738215.png)



## 什么是微服务？

微服务架构风格，就像是把一个 **单体应用开发为 一套小服务，每个小服务运行在自己的进程中**，并使用**轻量级机制通信**，通常是 HTTP API。这些服务围绕业务能力来构建，并通过完全自动化部署机制来独立部署。这些服务可以使用不同的编程语言书写，以及不同数据
存储技术，并保持最低限度的集中式管理。
简而言之 ： 拒绝大型单体应用 ， 基于业务边界进行服务微化拆分 ， 各个服务独立部署运行 。

1、服务拆分粒度更细

微服务可以是更细粒度的服务化，小到一个子模块，只要该模块依赖的资源与其他模块没有关系，就可以拆分为一个微服务。

2、服务独立部署

传统的单体应用是以整个系统为单位进行部署的，而微服务是以每一个独立组件（商品服务，用户服务）为单位进行部署。

![image-20220309213241962](https://raw.githubusercontent.com/xuhaoyao/images/master/img/image-20220309213241962.png)

比如根据每个服务的吞吐量不同，支付服务需要部署100台机器，用户服务需要部署30台机器，而商品服务只需要部署10台机器。这种灵活部署只有微服务架构才能实现。

3、服务独立部署，分工可以更加明确。比如将支付模块给一些人做，商品模块给另外一些人做。